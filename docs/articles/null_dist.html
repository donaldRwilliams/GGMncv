<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NCT: Null Distributions • GGMncv</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="NCT: Null Distributions">
<meta property="og:description" content="GGMncv">
<meta property="og:image" content="https://donaldrwilliams.github.io/GGMncv/reference/figures/hex.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@wdonald_1985">
<meta name="twitter:site" content="@wdonald_1985">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GGMncv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cpu_time.html">NCT: CPU Time</a>
    </li>
    <li>
      <a href="../articles/high_dim.html">High Dimensional Data: Must Read!!</a>
    </li>
    <li>
      <a href="../articles/nct_custom.html">Custom Network Comparison Tests</a>
    </li>
    <li>
      <a href="../articles/null_dist.html">NCT: Null Distributions</a>
    </li>
    <li>
      <a href="../articles/sign_restrict.html">Positive Manifold (Sign Restriction)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/donaldRwilliams/GGMncv/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="null_dist_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>NCT: Null Distributions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/donaldRwilliams/GGMncv/blob/master/vignettes/null_dist.Rmd"><code>vignettes/null_dist.Rmd</code></a></small>
      <div class="hidden name"><code>null_dist.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <strong>GGMncv</strong> network comparison test was vetted by investigating the distribution of <span class="math inline">\(p\)</span>-values under the null hypothesis, which should be uniform. If so, this would indicate that the implementation is correct, in so far as providing error rates at the nominal level (i.e., <span class="math inline">\(\alpha\)</span>).</p>
<p>On the other hand, power to detect differences was not investigated compared to the implementation in the <code>R</code> package <strong>NetworkComparisonTest</strong> <span class="citation">(Van Borkulo et al. 2017)</span>. This could be an interesting future direction.</p>
</div>
<div id="de-sparsified-glasso" class="section level1">
<h1 class="hasAnchor">
<a href="#de-sparsified-glasso" class="anchor"></a>De-Sparsified Glasso</h1>
<p>Following the approach of <span class="citation">Jankova and Van De Geer (2015)</span>, the de-sparsified glasso estimator can be computed without data driven selection of the regularization parameter. This is accomplished by setting <span class="math inline">\(\lambda = \sqrt(log(p)/n)\)</span>. The advantage is that this will be very (very) fast. That speed, however, should not come at the cost of a compromised test statistic under the null.</p>
<p>The following looks at the default test statistics using <code>desparsified = TRUE</code> (the default). Note for actual use, <code>iter</code> should be set to, say, at least 1,000 and perhaps even 10,000 to get a stable <span class="math inline">\(p\)</span>-value.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">GGMncv</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span>

<span class="va">main</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_net.html">gen_net</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">10</span>, edge_prob <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>

<span class="va">sims</span> <span class="op">&lt;-</span> <span class="fl">1000</span>

<span class="va">p_st</span> <span class="op">&lt;-</span> <span class="va">p_max</span> <span class="op">&lt;-</span> <span class="va">p_kl</span> <span class="op">&lt;-</span> <span class="va">p_sse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">sims</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">sims</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, 
                      mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, 
                      Sigma <span class="op">=</span> <span class="va">main</span><span class="op">$</span><span class="va">cors</span><span class="op">)</span>
  
  <span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, 
                      mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, 
                      Sigma <span class="op">=</span> <span class="va">main</span><span class="op">$</span><span class="va">cors</span><span class="op">)</span>
  
  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nct.html">nct</a></span><span class="op">(</span><span class="va">y1</span>, <span class="va">y2</span>, 
               desparsify <span class="op">=</span> <span class="cn">TRUE</span>, 
               cores <span class="op">=</span> <span class="fl">1</span>,
               iter <span class="op">=</span> <span class="fl">250</span>,
               penalty <span class="op">=</span> <span class="st">"lasso"</span>,
               update_progress <span class="op">=</span> <span class="fl">2</span>,
               penalize_diagonal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  
  <span class="va">p_kl</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">jsd_pvalue</span>
  <span class="va">p_st</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">glstr_pvalue</span>
  <span class="va">p_max</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">max_pvalue</span>
  <span class="va">p_sse</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">sse_pvalue</span>

<span class="op">}</span></code></pre></div>
<div id="distribution-of-p-values" class="section level2">
<h2 class="hasAnchor">
<a href="#distribution-of-p-values" class="anchor"></a>Distribution of <span class="math inline">\(p\)</span>-values</h2>
<p>The following distribution should be uniform. Because I only used 1,000 simulations, however, there might be some slight departures.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">p_kl</span>, main <span class="op">=</span> <span class="st">"KL-divergence"</span>, 
     xlab <span class="op">=</span> <span class="st">"p-values"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">p_st</span>, main <span class="op">=</span> <span class="st">"Global Strength"</span>, 
     xlab <span class="op">=</span> <span class="st">"p-values"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">p_max</span>, main <span class="op">=</span> <span class="st">"Maximum Difference"</span>, 
     xlab <span class="op">=</span> <span class="st">"p-values"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">p_sse</span>, main <span class="op">=</span> <span class="st">"Sum of Squares"</span>, 
     xlab <span class="op">=</span> <span class="st">"p-values"</span><span class="op">)</span></code></pre></div>
<p><img src="../man/figures/p_dist.png"></p>
<p>That appears really close! Also note a seed was not set, so if the above code is run, the results could be a bit different.</p>
</div>
<div id="qqplot" class="section level2">
<h2 class="hasAnchor">
<a href="#qqplot" class="anchor"></a>QQplot</h2>
<p>Next is a qqplot. Here the <span class="math inline">\(p\)</span>-values should fall along the line that corresponds to the quantiles calculated from a theoretical, in this case uniform, distribution.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot</a></span><span class="op">(</span>
  <span class="va">p_kl</span>,
  distribution  <span class="op">=</span> <span class="st">"unif"</span>,
  ylab <span class="op">=</span> <span class="st">"p-values"</span>,
  id <span class="op">=</span> <span class="cn">FALSE</span>,
  main <span class="op">=</span> <span class="st">'KL-divergence'</span>
<span class="op">)</span>

<span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot</a></span><span class="op">(</span>
  <span class="va">p_st</span>,
  distribution  <span class="op">=</span> <span class="st">"unif"</span>,
  ylab <span class="op">=</span> <span class="st">"p-values"</span>,
  id <span class="op">=</span> <span class="cn">FALSE</span>,
  main <span class="op">=</span> <span class="st">"Global Strength"</span>
<span class="op">)</span>

<span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot</a></span><span class="op">(</span>
  <span class="va">p_max</span>,
  distribution  <span class="op">=</span> <span class="st">"unif"</span>,
  ylab <span class="op">=</span> <span class="st">"p-values"</span>,
  id <span class="op">=</span> <span class="cn">FALSE</span>,
  main <span class="op">=</span> <span class="st">"Maximum Difference"</span>
<span class="op">)</span>

<span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot</a></span><span class="op">(</span>
  <span class="va">p_sse</span>,
  distribution  <span class="op">=</span> <span class="st">"unif"</span>,
  ylab <span class="op">=</span> <span class="st">"p-values"</span>,
  id <span class="op">=</span> <span class="cn">FALSE</span>,
  main <span class="op">=</span> <span class="st">"Sum of Squares"</span>
<span class="op">)</span></code></pre></div>
<p><img src="../man/figures/qqplot.png"></p>
<p>Again, that looks pretty good.</p>
</div>
<div id="error-rate" class="section level2">
<h2 class="hasAnchor">
<a href="#error-rate" class="anchor"></a>Error rate</h2>
<p>Here is the type 1 error rate for each test statistic</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># kl</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p_kl</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="co">#&gt; [1] 0.042</span>

<span class="co"># global strength</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p_st</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="co">#&gt; [1] 0.06</span>

<span class="co"># max diff</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p_max</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="co">#&gt; [1] 0.041</span>

<span class="co"># sum of squares</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">p_sse</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="co">#&gt; [1] 0.043</span></code></pre></div>
<p><em>Really</em> close to the nominal level.</p>
</div>
</div>
<div id="discussion" class="section level1">
<h1 class="hasAnchor">
<a href="#discussion" class="anchor"></a>Discussion</h1>
<p>For custom test stats (e.g., provided to <code>FUN</code>), it is really informative to investigate the the p-value distribution. Perhaps there are some that are overly conservative, which would indicate the test is not very powerful.</p>
<p>Although not included here, setting <code>desparsified = FALSE</code> was also investigated. The results were much the same, but took a lot longer (because, for each permutation, the tuning parameter is selected).</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-jankova2015confidence" class="csl-entry">
Jankova, Jana, and Sara Van De Geer. 2015. <span>“Confidence Intervals for High-Dimensional Inverse Covariance Estimation.”</span> <em>Electronic Journal of Statistics</em> 9 (1): 1205–29.
</div>
<div id="ref-van2017comparing" class="csl-entry">
Van Borkulo, Claudia D, Lynn Boschloo, J Kossakowski, Pia Tio, Robert A Schoevers, Denny Borsboom, and Lourens J Waldorp. 2017. <span>“Comparing Network Structures on Three Aspects: A Permutation Test.”</span> <em>Manuscript Submitted for Publication</em> 10.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Donald Williams.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
