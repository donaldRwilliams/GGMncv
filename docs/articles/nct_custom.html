<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Custom Network Comparison Tests • GGMncv</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Custom Network Comparison Tests">
<meta property="og:description" content="GGMncv">
<meta property="og:image" content="https://donaldrwilliams.github.io/GGMncv/reference/figures/hex.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@wdonald_1985">
<meta name="twitter:site" content="@wdonald_1985">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GGMncv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cpu_time.html">NCT: CPU Time</a>
    </li>
    <li>
      <a href="../articles/high_dim.html">High Dimensional Data: Must Read!!</a>
    </li>
    <li>
      <a href="../articles/nct_custom.html">Custom Network Comparison Tests</a>
    </li>
    <li>
      <a href="../articles/null_dist.html">NCT: Null Distributions</a>
    </li>
    <li>
      <a href="../articles/sign_restrict.html">Positive Manifold (Sign Restriction)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/donaldRwilliams/GGMncv/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="nct_custom_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Custom Network Comparison Tests</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/donaldRwilliams/GGMncv/blob/master/vignettes/nct_custom.Rmd"><code>vignettes/nct_custom.Rmd</code></a></small>
      <div class="hidden name"><code>nct_custom.Rmd</code></div>

    </div>

    
    
<div id="introdution" class="section level1">
<h1 class="hasAnchor">
<a href="#introdution" class="anchor"></a>Introdution</h1>
<p>A key feature of <code>nct</code> is the ability to test anything hypothesis, as opposed to the set of defaults provided in the <code>R</code> package <strong>NetworkComparisonTest</strong> <span class="citation">(Van Borkulo et al. 2017)</span>.</p>
</div>
<div id="correlation" class="section level1">
<h1 class="hasAnchor">
<a href="#correlation" class="anchor"></a>Correlation</h1>
<p>This first example compares the correlation between edges</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">GGMncv</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>

<span class="va">main</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_net.html">gen_net</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, 
                    mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, 
                    Sigma <span class="op">=</span> <span class="va">main</span><span class="op">$</span><span class="va">cors</span><span class="op">)</span>

<span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, 
                    mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, 
                    Sigma <span class="op">=</span> <span class="va">main</span><span class="op">$</span><span class="va">cors</span><span class="op">)</span>

<span class="va">Correlation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">upper.tri</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">upper.tri</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">compare_ggms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nct.html">nct</a></span><span class="op">(</span><span class="va">y1</span>, <span class="va">y2</span>, 
                    FUN <span class="op">=</span> <span class="va">Correlation</span>, 
                    progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">compare_ggms</span>
<span class="co">#&gt; Network Comparsion Test</span>
<span class="co">#&gt; (GGMncv Edition)</span>
<span class="co">#&gt; ----</span>
<span class="co">#&gt; Maximum Difference</span>
<span class="co">#&gt; p-value: 0.756 </span>
<span class="co">#&gt; ----</span>
<span class="co">#&gt; Global Strength</span>
<span class="co">#&gt; p-value: 0.904 </span>
<span class="co">#&gt; ----</span>
<span class="co">#&gt; Sum of Squared Error</span>
<span class="co">#&gt; p-value: 0.938 </span>
<span class="co">#&gt; ----</span>
<span class="co">#&gt; Jensen-Shannon divergence</span>
<span class="co">#&gt; p-value: 0.929 </span>
<span class="co">#&gt; ----</span>
<span class="co">#&gt; note: compute p-values manually for custom tests. see vignettes.</span></code></pre></div>
<p>By default, the <span class="math inline">\(p\)</span>-value corresponds to the proportion of the null distribution greater than the observed. For some test statistics, this might not make sense so they are not provided.</p>
<p>A fail safe is to visualize the results and compute the <span class="math inline">\(p\)</span>-value manually.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">compare_ggms</span><span class="op">$</span><span class="va">Correlation_perm</span>, 
     main <span class="op">=</span> <span class="st">"null dist: correlation"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">compare_ggms</span><span class="op">$</span><span class="va">Correlation_obs</span><span class="op">)</span></code></pre></div>
<p><img src="nct_custom_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Because a higher correlation is a good thing, 1 minus the proportion of the null distribution greater than the observed make sense.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">compare_ggms</span><span class="op">$</span><span class="va">Correlation_perm</span> <span class="op">&gt;</span> <span class="va">compare_ggms</span><span class="op">$</span><span class="va">Correlation_obs</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.918</span></code></pre></div>
</div>
<div id="predictability" class="section level1">
<h1 class="hasAnchor">
<a href="#predictability" class="anchor"></a>Predictability</h1>
<p>Next is predictability, or <span class="math inline">\(R^2\)</span>, for the first node in the networks. The first step is defining a function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define function</span>
<span class="va">r2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  
  <span class="co"># network 1</span>
  <span class="va">inv1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu">corpcor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corpcor/man/cor2pcor.html">pcor2cor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
  <span class="va">beta1</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">inv1</span><span class="op">[</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">inv1</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>
  <span class="va">r21</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">y1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">y1</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">beta1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
  
  <span class="co"># network 2</span>
  <span class="va">inv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu">corpcor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corpcor/man/cor2pcor.html">pcor2cor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
  <span class="va">beta2</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">inv2</span><span class="op">[</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">inv2</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>
  <span class="va">r22</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">y2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">y2</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">beta2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">r21</span> <span class="op">-</span> <span class="va">r22</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Next use <code>nct</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">compare_ggms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nct.html">nct</a></span><span class="op">(</span><span class="va">y1</span>, <span class="va">y2</span>, 
                    progress <span class="op">=</span> <span class="cn">FALSE</span>,
                    FUN <span class="op">=</span> <span class="va">r2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">compare_ggms</span><span class="op">$</span><span class="va">r2_perm</span>,  
     main <span class="op">=</span> <span class="st">"null dist: R2 Difference"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">compare_ggms</span><span class="op">$</span><span class="va">r2_obs</span><span class="op">)</span></code></pre></div>
<p><img src="nct_custom_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Note anything can be tested, say, expected influence. As such, this is not limited to only one value returned by the custom function (as in the above examples), but can be any number. There is an example in the documentation.</p>
<p>Further, although not provided here, both tests could have been done at the same time by passing a list to <code>FUN</code>, i.e., <code>list_fun &lt;- list(r2 = r2, Correlation = Correlation)</code>.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-van2017comparing" class="csl-entry">
Van Borkulo, Claudia D, Lynn Boschloo, J Kossakowski, Pia Tio, Robert A Schoevers, Denny Borsboom, and Lourens J Waldorp. 2017. <span>“Comparing Network Structures on Three Aspects: A Permutation Test.”</span> <em>Manuscript Submitted for Publication</em> 10.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Donald Williams.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
