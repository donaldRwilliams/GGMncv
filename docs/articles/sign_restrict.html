<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Positive Manifold (Sign Restriction) â€¢ GGMncv</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Positive Manifold (Sign Restriction)">
<meta property="og:description" content="GGMncv">
<meta property="og:image" content="https://donaldrwilliams.github.io/GGMncv/reference/figures/hex.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@wdonald_1985">
<meta name="twitter:site" content="@wdonald_1985">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GGMncv</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sign_restrict.html">Positive Manifold (Sign Restriction)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/donaldRwilliams/GGMncv/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sign_restrict_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Positive Manifold (Sign Restriction)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/donaldRwilliams/GGMncv/blob/master/vignettes/sign_restrict.Rmd"><code>vignettes/sign_restrict.Rmd</code></a></small>
      <div class="hidden name"><code>sign_restrict.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>For some research questions, there might be expectations in regards to the directions of the edges. For example, in symptom networks, all relations are often hypothesized to be positive (i.e., positive manifold). In turn, any negative relations are thought to be spurious.</p>
<p>In <strong>GGMncv</strong>, it is possible to estimate the conditional dependence structure, given that all edges in the graph are positive (sign restriction).</p>
<div id="packages" class="section level2">
<h2 class="hasAnchor">
<a href="#packages" class="anchor"></a>Packages</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">GGMncv</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="correlations" class="section level2">
<h2 class="hasAnchor">
<a href="#correlations" class="anchor"></a>Correlations</h2>
<p>The <code>ptsd</code> dataset includes 20 post-traumatic stress symptoms. The following visualizes the correlation matrix:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">ptsd</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"shade"</span><span class="op">)</span></code></pre></div>
<p><img src="sign_restrict_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Notice that all of the correlations are positive.</p>
</div>
<div id="partial-correlations" class="section level2">
<h2 class="hasAnchor">
<a href="#partial-correlations" class="anchor"></a>Partial Correlations</h2>
<p>Here are the partial correlations:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pcors</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">ptsd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ptsd</span><span class="op">)</span><span class="op">)</span>

<span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">pcors</span>, 
                   method <span class="op">=</span> <span class="st">"shade"</span><span class="op">)</span></code></pre></div>
<p><img src="sign_restrict_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Notice that some relations went to essentially zero (white), whereas other changed direction altogether.</p>
</div>
<div id="ggm" class="section level2">
<h2 class="hasAnchor">
<a href="#ggm" class="anchor"></a>GGM</h2>
<p>Here the conditional dependence structure is selected via <code>ggmncv</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fit model</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggmncv.html">ggmncv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">ptsd</span><span class="op">)</span>, 
              n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ptsd</span><span class="op">)</span>, 
              progress <span class="op">=</span> <span class="cn">FALSE</span>, 
              penalty <span class="op">=</span> <span class="st">"atan"</span><span class="op">)</span>

<span class="co"># plot graph</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_graph.html">get_graph</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>, 
     edge_magnify <span class="op">=</span> <span class="fl">10</span>, 
     node_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">ptsd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="sign_restrict_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Notice a few negatives are included in the graph.</p>
</div>
<div id="sign-restriction" class="section level2">
<h2 class="hasAnchor">
<a href="#sign-restriction" class="anchor"></a>Sign Restriction</h2>
<p>Here the graph is re-estimated, with the constraint that all of negative edges in the above plot are actually zero.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set negatives to zero (sign restriction)</span>
<span class="va">adj_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">P</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">check_zeros</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>

<span class="co"># track trys</span>
<span class="va">iter</span> <span class="op">&lt;-</span> <span class="fl">0</span>

<span class="co"># iterate until all positive</span>
<span class="kw">while</span><span class="op">(</span><span class="va">check_zeros</span><span class="op">)</span><span class="op">{</span>
  <span class="va">iter</span> <span class="op">&lt;-</span> <span class="va">iter</span> <span class="op">+</span> <span class="fl">1</span>
  <span class="va">fit_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/constrained.html">constrained</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">ptsd</span><span class="op">)</span>, adj <span class="op">=</span> <span class="va">adj_new</span><span class="op">)</span>
  <span class="va">check_zeros</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">fit_new</span><span class="op">$</span><span class="va">wadj</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span>
  <span class="va">adj_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">fit_new</span><span class="op">$</span><span class="va">wadj</span> <span class="op">&lt;=</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># make graph object</span>
<span class="va">new_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>P <span class="op">=</span> <span class="va">fit_new</span><span class="op">$</span><span class="va">wadj</span>,
                  adj <span class="op">=</span> <span class="va">adj_new</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">new_graph</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"graph"</span>

<span class="co"># plot graph</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">new_graph</span>,
     edge_magnify <span class="op">=</span> <span class="fl">10</span>,
     node_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">ptsd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="sign_restrict_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The graph now only includes positive edges. Note this is not the same as simply removing the negative relations, as, in this case, this is the maximum likelihood estimate for the inverse covariance matrix.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Donald Williams.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
